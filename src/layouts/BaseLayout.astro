---
import ThemeToggle from '@/components/ThemeToggle.astro';
import Seo from '@/components/Seo.astro';
const title = Astro.props.title ?? import.meta.env.AGENCY_NAME ?? 'Vtuber Site Sample';
const description = Astro.props.description ?? undefined;
const ogImage = Astro.props.ogImage ?? undefined;
const ogType = Astro.props.ogType ?? undefined;
const site = Astro.site?.toString().replace(/\/$/, '') ?? '';
const agency = import.meta.env.AGENCY_NAME ?? 'Vtuber Agency';
---
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <Seo title={title} description={description} image={ogImage} type={ogType} />
    <link rel="icon" href="/favicon.ico" />
    <link rel="stylesheet" href="/fonts.css" />
    <link rel="stylesheet" href="/global.css" />
    <script>
      try {
        const saved = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if ((saved ?? (prefersDark ? 'dark' : 'light')) === 'dark') {
          document.documentElement.classList.add('dark');
        }
      } catch {}
    </script>
    <script type="application/ld+json">
      {JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'Organization',
        name: agency,
        url: site || undefined,
        logo: site ? `${site}/og.png` : '/og.png',
      })}
    </script>
    <script type="application/ld+json">
      {JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'WebSite',
        name: agency,
        url: site || undefined,
      })}
    </script>
  </head>
  <body class="min-h-screen flex flex-col">
    <header class="border-b border-gray-200 dark:border-gray-800 bg-white/70 dark:bg-gray-950/70 backdrop-blur">
      <div class="mx-auto max-w-6xl px-4 py-4 flex items-center justify-between">
        <a href="/" class="text-xl font-bold text-brand">{import.meta.env.AGENCY_NAME ?? 'Agency'}</a>
        <nav class="flex gap-6 items-center text-sm">
          <a href="/members" class="hover:text-brand">メンバー</a>
          <a href="/news" class="hover:text-brand">ニュース</a>
          <a href="https://twitter.com" target="_blank" class="hover:text-brand">X</a>
          <div class="ml-2"><ThemeToggle /></div>
        </nav>
      </div>
    </header>
    <main class="flex-1">
      <slot />
    </main>
    <footer class="border-t border-gray-200 dark:border-gray-800 py-8 text-center text-sm text-gray-500">
      © {new Date().getFullYear()} {import.meta.env.AGENCY_NAME ?? 'Agency'}
    </footer>
  </body>
</html>

<style is:global>
  @import '/src/styles/global.css';
</style>
